{% extends "enrollment/courses/base.html" %}

{% block main-subtitle %}
	{{group.course.name}}
	({{group.get_type_display}}: {{group.get_teacher_full_name}})
{% endblock %}

{% block enrollment_menu_courses %} class="active"{% endblock %}

{% block styles %}
    {{ block.super }}
    <link href="/site_media/css/enrollment/courses.css"  rel="stylesheet">
{% endblock %}


{% block bread %}
	<a href="{% url main-page %}">Strona główna</a> &raquo;
	<a href="{% url enrollment-main %}">Zapisy</a> &raquo;
	<a href="{% url course-list %}">Przedmioty</a> &raquo;

	<a href="{% url course-page group.course.slug %}"
			>{{group.course.name}}</a> &raquo;

	{{group.get_type_display}}: {{group.get_teacher_full_name}}
{% endblock %}



{% block content %}
	<div id="enr-group-view">


        <h1>{{group.course.name}}</h1>
        {% if user.is_staff %}
        <a href="{% url admin:courses_group_change group.pk %}">Edycja</a>
        {% endif %}
        <div class="details">
            <table>
                <tr>
                    <th>Typ</th>
                    <td>{{group.get_type_display}}</td>
                </tr>

                    <tr>
                        <th>Prowadzący</th>
                        <td>

                    {% if group.teacher %}
                        <a href="{% url employee-profile group.teacher.user.id %}" class="person">{{group.get_teacher_full_name}}</a>
                    {% else %}
                        {{group.get_teacher_full_name}}
                    {% endif %}</td>
                    </tr>

                <tr>
                    <th>Termin</th>
                    <td>
                    {% for term in group.get_all_terms %}
                        {{term}}{%if not forloop.last %}, {% endif %}
                    {% endfor %}</td>
                </tr>


            </table>


        </div>

        <hr>

		<br/>
		<h3>Lista osób zapisanych na przedmiot:</h3>
		{% if group.limit_zamawiane %}
			<p>Zapisanych w ramach limitu studiów zamawianych:
				{{ group.number_of_students_zamawiane }}
				/ {{ group.limit_zamawiane }}.
			</p>
			<p>Zapisanych w ramach limitu dodatkowego:
				{{ group.number_of_students_non_zamawiane }}
				/ {{ group.limit_non_zamawiane }}.
			</p>
		{% else %}
			<p>Liczba zapisanych osób: {{students_in_group|length}} /
			{{group.get_group_limit}}</p>
		{% endif %}

		<br/>
		
		<table class="zebra-striped">
			<thead>
				<th>Imię</t>
				<th>Nazwisko</t>
				<th>Nr indeksu</th>
				<th>Rodzaj studiów</th>
				<th>Semestr</th>
			</thead>
			<tbody>
				{% for student in students_in_group %}
					<tr>
						<td><a href="{% url student-profile student.user.id %}" class="person">
						    {{student.user.first_name}}</a></td>
						<td><a href="{% url student-profile student.user.id %}" class="person">
						    {{student.user.last_name}}</a></td>
						<td>{{student.matricula}}</td>
						<td>
							{{student.program}}
							{% if student.is_zamawiany %}
								(zamawiane)
							{% endif %}
						</td>
						<td>{{student.semestr}}</td>
					</tr>
			
				{% empty %}
					Brak zapisanych osób.
				{% endfor %}
			</tbody>
		</table><br />
        <a href="mailto:{% for student in students_in_group %},{{ student.user.email }}{% endfor %}">[Wyślij wiadomość do grupy]</a>
		<br/>
		{%if students_in_queue %}
			<h3>Lista osób oczekujących na zapis:</h3>
			<p> Liczba osób oczekujących na zapis: {{students_in_queue|length}} </p>
			<br/>
		<table class="zebra-striped">
			<thead>
				<th>Imię</t>
				<th>Nazwisko</t>
				<th>Nr indeksu</th>
				<th>Rodzaj studiów</th>
				<th>Semestr</th>
			</thead>
				<tbody>
					{% for student in students_in_queue %}
						<tr>
							<td><a href="{% url student-profile student.user.id %}"{% if student.pk == user.student.pk %} class="bold"{% endif %}>
							    {{student.user.first_name}}</a></td>
							<td><a href="{% url student-profile student.user.id %}"{% if student.pk == user.student.pk %} class="bold"{% endif %}>
							    {{student.user.last_name}}</a></td>
							<td {% if student.pk == user.student.pk %} class="bold"{% endif %}>{{student.matricula}}</td>
							<td>
								{{student.program}}
								{% if student.is_zamawiany %}
									(zamawiane)
								{% endif %}
							</td>
						</tr>
					{% endfor %}
				</tbody>
			</table>
		{% endif %}
	</div>
{% endblock %}
