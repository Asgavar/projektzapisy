{% extends "offer/vote/index.html" %}

{% load compressed %}

{% block main-subtitle %}Głosowanie{% endblock %}


{% block bread %}
    <a href="/">Strona główna</a> &raquo;
    <a href="{% url offer-main %}">Oferta dydaktyczna</a> &raquo;
    <a href="{% url vote-main %}">Głosowanie</a> &raquo;
    Oddaj głos
    {# end bread #}
{% endblock %}


{% block js %}
    {% if not isCorrectionActive %}
        {% compressed_js 'vote_form' %}
    {% else %}
        {% compressed_js 'correction_form' %}
    {% endif %}
{% endblock %}

{% block top-bar %}
    <div id="od-vote-top-bar" class="main-top-bar" style="display: none">
        <fieldset id="od-vote-filter">
            <legend><span>Filtrowanie</span></legend>
            <div class="main-filter-input">
                <input class="text filter-phrase" type="text"/>
                <input class="reset filter-phrase-reset" type="button" value="X" style="display:none;"/>
            </div>
        </fieldset>
        <fieldset class="course-type-filter">
            <legend><span>Rodzaj przedmiotu</span></legend>
            {% for type in proposalTypes %}
                <span class="checkbox">
					<input type="checkbox" checked="checked"
                           id="filter-course-type-{{ type.id }}" {% if type.meta_type %}
                           class="filter-course-type-meta" {% endif %} value="{{ type.id }}"/>
					<input type="hidden" class="group-id" value="{{ type.group.id }}"/>
					<label for="filter-course-type-{{ type.id }}">{{ type.name }}</label>
				</span>
            {% endfor %}
        </fieldset>
        <fieldset id="od-vote-other">
            <legend><span>Inne</span></legend>
            <span class="checkbox"><input type="checkbox" id="od-vote-onlywanted"/><label for="od-vote-onlywanted"
                                                                                          title="Pokazuje tylko te propozycje przedmiotów, które oznaczyłeś przyciskiem &quot;Pójdę na to&quot;">Pokaż
                tylko przedmioty, na które chcę iść</label></span>
            <span class="checkbox"><input type="checkbox" id="od-vote-withoutcompleted" disabled="disabled"/><label
                    for="od-vote-withoutcompleted">Nie pokazuj przedmiotów, na które już chodziłem</label></span>
        </fieldset>
    </div>
{% endblock %}

{% block content %}
    <form action="" method="post" id="od-vote-form">{% csrf_token %}
        {{ formset.winter.formset.management_form }}
        {{ formset.summer.formset.management_form }}
        {{ formset.unknown.formset.management_form }}
        {% if formset.winter.formset.total_form_count > 0 %}
        <div class="od-vote-semester" id="od-vote-semester-winter"><h2>Semestr zimowy</h2>
            <ul>
                {% for form in formset.winter.formset %}
                    {% for field in  form.hidden_fields %}
                        {{ field }}
                    {% endfor %}
                <li class="od-vote-course winter course-type-{{ form.instance.entity.type.id }}">
                   <label for="id_{% if isCorrectionActive %}{{ form.correction.html_name }}{% else %}{{ form.value.html_name }}{% endif %}"><a href="{% url offer-page form.instance.entity.slug %}">{{ form.instance.entity.name }}</a></label>
                    {% if isCorrectionActive %}
                        <input type="hidden" class="value" value="{{ form.instance.value }}">
                        {{ form.correction }}
                    {% else %}
                        {{ form.value }}
                    {% endif %}
                </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
        {% if formset.summer.formset.total_form_count > 0 %}
        <div class="od-vote-semester" id="od-vote-semester-summer"><h2>Semestr letni</h2>
            <ul>
                {% for form in formset.summer.formset %}
                <li class="od-vote-course summer course-type-{{ form.instance.entity.type.id }}">
                    {% for field in  form.hidden_fields %}
                        {{ field }}
                    {% endfor %}
                    <label for="id_{% if isCorrectionActive %}{{ form.correction.html_name }}{% else %}{{ form.value.html_name }}{% endif %}"><a href="{% url offer-page form.instance.entity.slug %}">{{ form.instance.entity.name }}</a></label>
                    {% if isCorrectionActive %}
                        <input type="hidden" class="value" value="{{ form.instance.value }}">
                        {{ form.correction }}{% else %}
                        {{ form.value }}{% endif %}
                </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
        {% if formset.unknown.formset.total_form_count > 0 %}
        <div class="od-vote-semester" id="od-vote-semester-unknown"><h2>Semestr nieokreślony</h2>
            <ul>
                {% for form in formset.unknown.formset %}
                <li class="od-vote-course unknown course-type-{{ form.instance.entity.type.id }}">
                    {% for field in  form.hidden_fields %}
                        {{ field }}
                    {% endfor %}
                    <label for="id_{% if isCorrectionActive %}{{ form.correction.html_name }}{% else %}{{ form.value.html_name }}{% endif %}"><a href="{% url offer-page form.instance.entity.slug %}">{{ form.instance.entity.name }}</a></label>
                    {% if isCorrectionActive %}
                        <input type="hidden" class="value" value="{{ form.instance.value }}">
                        {{ form.correction }}{% else %}{{ form.value }}
                    {% endif %}
                </li>
                {% endfor %}</ul>
        </div>
        {% endif %}

        <p id="od-vote-submitBar"><input type="submit" value="Głosuj"/></p>
    </form>
       <p id="od-vote-maxPoints">Maksymalna liczba punktów do wykorzystania: <span>{{ formset.points_limit }}</span></p>
{% endblock %}
